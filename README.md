# EasyBeetl

[Demo地址](http://easybeetl.cimoc.cn)

## 使用说明

### 类型

easybeetl 将 beetl 表达式分为三种类型：

1. 字符串
2. 变量或数值
3. 表达式

#### 1. 字符串

字符串类型就是需要加双引号的数据，例如 `"hello"`

#### 2. 变量或数值

变量或数值等不需要双引号的数据，例如 `15` 、`variable`

#### 3. 表达式

除了上述两种类型以外，所有的其他类型都归类为表达式

* beetl 函数是表达式：`isEmpty(xxx)`
* 参数是表达式：`10, 20`

### 按钮

demo演示地址中有3个按钮

![image-20221218115000383](https://cdn.cimoc.cn/img/image-20221218115000383.png)

![image-20221218115016143](https://cdn.cimoc.cn/img/image-20221218115016143.png)

![image-20221218115023094](https://cdn.cimoc.cn/img/image-20221218115023094.png)

* 新建/重置，用来重新创建 beetl 表达式
* 获取stack，是开发时用来debug的
* 渲染，将创建的beetl输出到 F12 控制台

### 行

demo 中以“行”表示每一段独立的 easybeetl

![image-20221218115205207](https://cdn.cimoc.cn/img/image-20221218115205207.png)

同一层级的“行”，左边的颜色相同

![image-20221218115235303](https://cdn.cimoc.cn/img/image-20221218115235303.png)

右边有两个按钮，添加按钮代表这在当前行的后面（同一层级）添加一个新行

### 元素

行内有三个元素：方法、类型、填充值

#### 类型

其中，只有类型为**字符串**或者**变量或数值**才需要填充值，若类型为表达式，那么将自动创建下一层级的行

#### 方法

方法分为5大类：核心方法、基本方法、字符串方法、数组方法、正则方法

其中后4类为 beetl函数，而核心方法则是基本语法

> 核心方法

| 描述                   | 方法签名               |
| :--------------------- | :--------------------- |
| 表达式以字符或变量开头 | 表达式以字符或变量开头 |
| 字符串拼接             | +                      |
| 参数拼接               | ,                      |
| 创建If                 | ?                      |
| If = True              | :                      |
| If = False             | :                      |
| 数值运算加法           | +                      |
| 数值运算减法           | -                      |
| 数值运算乘法           | *                      |
| 数值运算除法           | /                      |
| 括号                   | ()                     |

> 基本方法

| 获取当前时间       | date()                      |
| ------------------ | --------------------------- |
| 返回指定日期       | date(日期, 格式化规则)      |
| 打印一个对象       | print(对象)                 |
| 打印一个对象并换行 | println(对象)               |
| 打印文件           | printFile(文件地址)         |
| nvl                | nvl(对象, 字符串)           |
| 判断为空           | isEmpty(对象)               |
| 判断不为空         | isNotEmpty(对象)            |
| 截取数字或日期     | trim(对象, 位数/格式)       |
| 保留小数           | trunc(对象, 位数)           |
| 转换为整型         | parseInt(对象)              |
| 转换为长整型       | parseLong(对象)             |
| 转换为浮点数       | parseDouble(对象)           |
| 创建迭代器         | range(初始值, 结束值, 步长) |
| 转换为json         | json(对象)                  |
| 获取指定cookie对象 | cookie(对象)                |

> 字符串方法

| 判断是否以XX开头               | strutil.startWith(对象)                       |
| ------------------------------ | --------------------------------------------- |
| 判断是否以XX结尾               | strutil.endWith(对象)                         |
| 获取字符串长度                 | strutil.length(对象)                          |
| 截取从某个位置到末尾           | strutil.subString(对象, 起点)                 |
| 截取指定两个位置间的字符串     | strutil.subStringTo(对象, 起点, 终点)         |
| 以某个字符分割字符串为数组     | strutil.split(对象, 正则表达式)               |
| 判断是否存在某串字符           | strutil.contain(对象, 匹配字符串)             |
| 全部英文转大写                 | strutil.toUpperCase(对象)                     |
| 全部英文转小写                 | strutil.toLowerCase(对象)                     |
| 替换部分字符串                 | strutil.replace(对象, 匹配字符串, 替换字符串) |
| 格式化字符串                   | strutil.format(对象, 数量相符的参数)          |
| 去掉字符串尾部空格             | strutil.trim(对象)                            |
| 格式化日期                     | strutil.formatDate(对象, 格式)                |
| 获取指定字符串第一次出现下标   | strutil.index(对象)                           |
| 获取指定字符串最后一次出现下标 | strutil.laseIndex(对象)                       |

> 数组方法

| 描述                   | 方法签名                      |
| :--------------------- | :---------------------------- |
| 返回数组的一部分       | array.range(数组, 起点, 终点) |
| 删除数组的某个元素     | array.remove(数组, 元素)      |
| 向数组添加一个元素     | array.add(数组, 元素)         |
| 判断数组是否包含某元素 | array.contain(数组, 元素)     |
| 转化成数组             | array.toArray(多个元素)       |
| 将java集合转换为数组   | array.collection2Array(数组)  |

> 正则方法

| 描述                         | 方法签名                                |
| :--------------------------- | :-------------------------------------- |
| 判断是否匹配                 | reg.match(对象, 表达式)                 |
| 替换                         | reg.replace(对象, 表达式, 替换的字符串) |
| 查找第一个匹配的             | reg.find(对象, 表达式)                  |
| 查找所有匹配的               | reg.findList(对象, 表达式)              |
| 切分字符串返回列表           | reg.split(对象, 表达式)                 |
| 切分字符串返回列表并限制个数 | reg.split(对象, 表达式, 最多个数)       |

每一层级的开头默认方法都是“表达式以字符或变量开头”，这个方法的作用是，不对填充值做任何处理

要进行字符串的拼接操作，例如 `"a" + "b"`，那么在这一段中，"a" 应该使用的方法是：表达式以字符或变量开头

而 "b" 应该使用的是：字符串拼接

### 示例

#### 例1

有一个变量 name，当 name 不为空时，返回自身，否则返回“姓名为空”

根据需求，可以手写出 beetl 表达式：`${(isNotEmpty(name)?name:"姓名为空")}`

如果用 easybeetl，可以如下操作：

![image-20221218120218237](https://cdn.cimoc.cn/img/image-20221218120218237.png)

点击渲染按钮后，在控制台会输出结果：

![image-20221218120242941](https://cdn.cimoc.cn/img/image-20221218120242941.png)



#### 例2

给定两个变量 name 和 age，最终要呈现的结果是：`姓名：XXX，年龄：XX`

手写结果：`${"姓名："+(isNotEmpty(name)?name:"空")+"，"+(isNotEmpty(age)?age:"空")}`

easybeetl：

![image-20221218120606677](https://cdn.cimoc.cn/img/image-20221218120606677.png)

渲染结果：

![image-20221218120633867](https://cdn.cimoc.cn/img/image-20221218120633867.png)

#### 例3

有一个字符串变量 invoice，其可能以“发票”两个字结尾，也可能没有。要求删除发票两个字

有两个思路：要么使用 replace 替换“发票”，要么就进行复杂的判断，下面都用easybeetl给出演示

1. replace

   ![image-20221218120959028](https://cdn.cimoc.cn/img/image-20221218120959028.png)

   ![image-20221218121008032](https://cdn.cimoc.cn/img/image-20221218121008032.png)

2. 复杂判断

   ![image-20221218121246314](https://cdn.cimoc.cn/img/image-20221218121246314.png)

   ![image-20221218121252940](https://cdn.cimoc.cn/img/image-20221218121252940.png)
